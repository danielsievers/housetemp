# Snapping Verification Results

**Generated by:** `scripts/verify_snapping.py`  
**Energy Model:** Continuous (`run_model_continuous`)

> [!IMPORTANT]  
> **Known Limitation:** These results use the continuous energy model. Real-world thermostat behavior follows the discrete model (with hysteresis). Savings percentages may differ in production. Adding discrete model comparison is tracked as a future enhancement.

## Test Configuration

- **Heating:** 63-70°F (from `data/heating_comfort.json`)
- **Cooling:** 68-70°F (from `data/cooling_comfort.json`)
- **center_preference:** 0.2
- **Weights tested:**
  - Heating: W=0 (baseline) vs W=0.05 (prod)
  - Cooling: W=0 vs W=0.001 vs W=0.005 vs W=0.01

## Summary Table

| Scenario | Var | Mode | Naive kWh | W=0 kWh | Save% (W=0) | W=def kWh | Save% (W=def) | Result |
|----------|-----|------|-----------|---------|-------------|-----------|---------------|--------|
| shoulder | at_target | heat | 8.88 | 8.15 | 8.3% | 5.68 | **36.0%** | ✅ |
| shoulder | idle_opp | heat | 8.70 | 8.64 | 0.6% | 5.39 | **38.0%** | ✅ |
| shoulder | recovery | heat | 9.80 | 8.43 | 13.9% | 5.62 | **42.6%** | ✅ |
| mild_summer | at_target | cool | 3.08 | 3.20 | -4.0% | 0.53 | **82.9%** | ✅ |
| mild_summer | idle_opp | cool | 3.04 | 3.04 | 0.0% | 0.98 | **67.7%** | ✅ |
| mild_summer | recovery | cool | 2.94 | 2.06 | 29.7% | 1.79 | **39.0%** | ✅ |
| hot_summer | at_target | cool | 5.68 | 7.81 | -37.4% | 9.77 | -72.0% | ❌ |
| hot_summer | idle_opp | cool | 5.53 | 8.52 | -54.0% | 9.28 | -67.8% | ❌ |
| hot_summer | recovery | cool | 5.91 | 9.67 | -63.6% | 10.28 | -73.8% | ❌ |

> [!NOTE]
> Hot summer regressions are a known issue with aggressive cooling schedules (68-70°F target in extreme heat). This is pre-existing optimizer behavior, not a snapping bug.

## Production Configuration

| Mode | Weight | Rationale |
|------|--------|-----------|
| Heating | `W_BOUNDARY_PULL_HEAT = 0.05` | Works well in shoulder seasons |
| Cooling | `W_BOUNDARY_PULL_COOL = 0.0` | Disabled due to hot weather regressions |

## Plots

### Shoulder Season Heating
![W=0](../data/scenarios/setpoints_shoulder_season_at_target_W000_1766548695.png)
![W=0.05](../data/scenarios/setpoints_shoulder_season_at_target_W005_1766548695.png)

### Mild Summer Cooling
![W=0](../data/scenarios/setpoints_mild_summer_at_target_W000_1766548695.png)
![W=0.01](../data/scenarios/setpoints_mild_summer_at_target_W001_1766548695.png)

### Hot Summer Cooling (Regression)
![W=0](../data/scenarios/setpoints_hot_summer_at_target_W000_1766548695.png)
![W=0.01](../data/scenarios/setpoints_hot_summer_at_target_W001_1766548695.png)

## Reproducibility

To regenerate these results from HEAD:
```bash
.venv/bin/python scripts/verify_snapping.py
```

Results are saved to:
- `data/scenarios/snapping_diagnostics.json`
- `data/scenarios/setpoints_*.png`
